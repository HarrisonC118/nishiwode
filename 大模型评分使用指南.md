# 大模型自动评分使用指南

## 概述

本指南为"海河工匠杯"技能大赛Python编程题提供大模型自动评分方案。两组题目（学生组和职工组）各100分，分为4个任务。

---

## 评分文件说明

- **学生组评分标准.md**: 学生组详细评分表（EAN/UPC条码识别）
- **职工组评分标准.md**: 职工组详细评分表（服装尺码规格识别）

---

## 分数分配总览

### 学生组 (100分)
- **Task 1** (图像预处理): 20分
- **Task 2** (CNN模型训练): 30分
- **Task 3** (Tkinter GUI应用): 35分
- **Task 4** (训练结果可视化): 15分

### 职工组 (100分)
- **Task 1** (图像预处理): 20分
- **Task 2** (CRNN模型训练): 30分
- **Task 3** (Tkinter GUI应用): 35分
- **Task 4** (训练结果可视化): 15分

---

## 大模型评分Prompt模板

### 方式一：单文件评分

```
你是一位专业的Python编程竞赛评委。请根据以下评分标准对考生代码进行评分。

【评分标准】
[粘贴对应组别的完整评分标准]

【考生代码】
```python
[考生提交的完整代码]
```

【评分要求】
1. 逐个TODO检查，找出所有填空位置
2. 对比标准答案，判断每个空的正确性
3. 根据评分标准给出分数和理由
4. 计算该文件总分

【输出格式】
## 文件名: taskX.py
### TODO 1: [TODO描述]
- 空位1: [考生答案] | 标准答案: [标准答案] | 得分: X/Y分 | 理由: [简短说明]
- 空位2: ...

### TODO 2: ...

**文件总分**: X/20分
**主要问题**: [列出3-5个主要问题]
**改进建议**: [简短建议]
```

---

### 方式二：整套试题评分

```
你是一位专业的Python编程竞赛评委。请对考生的整套作品（Task1-4）进行综合评分。

【评分组别】: [学生组/职工组]

【评分标准】
[粘贴对应组别的完整评分标准]

【考生提交文件】

**task1.py**
```python
[task1代码]
```

**task2.py**
```python
[task2代码]
```

**task3.py**
```python
[task3代码]
```

**task4.py**
```python
[task4代码]
```

【评分要求】
1. 按照Task1→Task2→Task3→Task4的顺序评分
2. 每个TODO单独评分，说明得分理由
3. 总结各任务得分和总分
4. 指出代码亮点和主要问题

【输出格式】
# 评分报告 - [学生组/职工组]

## Task 1: 图像预处理 (X/20分)
[详细评分...]

## Task 2: 模型训练 (X/30分)
[详细评分...]

## Task 3: GUI应用 (X/35分)
[详细评分...]

## Task 4: 可视化 (X/15分)
[详细评分...]

---
## 总分: X/100分

## 代码亮点
1. ...
2. ...

## 主要问题
1. ...
2. ...

## 改进建议
1. ...
2. ...
```

---

## 评分原则说明

### 1. 完全正确 (100%分数)
- 代码与标准答案完全一致
- 或使用等效方法且功能正确

**示例**:
```python
# 标准答案
import numpy as np

# 等效答案（给满分）
import numpy as np
```

---

### 2. 部分正确 (70%-90%分数)
- 逻辑正确但有小错误
- 参数不完整但核心正确

**示例**:
```python
# 标准答案 (2分)
cv2.GaussianBlur(img_gray, (5, 5), 0)

# 部分正确 (1.5分) - 核大小不同但方法正确
cv2.GaussianBlur(img_gray, (3, 3), 0)
```

---

### 3. 基本正确 (40%-60%分数)
- 思路正确但实现有误
- 函数名正确但参数错误

**示例**:
```python
# 标准答案 (3分)
cv2.morphologyEx(gray, cv2.MORPH_CLOSE, kernel)

# 基本正确 (2分) - 操作类型错误
cv2.morphologyEx(gray, cv2.MORPH_OPEN, kernel)
```

---

### 4. 错误 (0分)
- 完全错误或空白
- 语法错误导致无法运行

---

## 特殊情况处理指南

### 情况1: 等效实现
**问题**: 考生使用了不同但功能相同的方法

**处理**:
```python
# 标准答案
gray_img.ravel()

# 等效答案（给满分）
gray_img.flatten()

# 部分正确（给50%分）
gray_img  # 缺少展平操作
```

**评分**: 功能完全等效给满分，部分等效给70%-90%

---

### 情况2: 参数变化
**问题**: 函数正确但参数在合理范围内变化

**处理**:
```python
# 标准答案 (2分)
cv2.bilateralFilter(gray_img, 9, 75, 75)

# 参数不同但合理 (1.5-2分)
cv2.bilateralFilter(gray_img, 5, 50, 50)

# 参数明显不合理 (1分)
cv2.bilateralFilter(gray_img, 1, 1, 1)
```

**评分**: 参数合理且效果相近给90%-100%，参数欠佳给60%-80%

---

### 情况3: 字符串格式化
**问题**: 使用不同的字符串格式化方法

**处理**:
```python
# 标准答案
f"{save_prefix}_hist_before.png"

# 等效方法（都给满分）
str(save_prefix) + "_hist_before.png"
"{}_hist_before.png".format(save_prefix)
"%s_hist_before.png" % save_prefix
```

**评分**: 只要结果正确，任何格式化方法都给满分

---

### 情况4: 模型架构变化
**问题**: CNN/CRNN层数或通道数不同

**处理**:
```python
# 标准答案: 16→32→64→128 (8分)

# 架构正确但通道数不同 (6-7分)
# 例如: 32→64→128→256

# 架构错误 (0-3分)
# 例如: 缺少层数或顺序错误
```

**评分**: 整体架构合理给60%-90%，架构错误给0%-40%

---

### 情况5: 导入库拼写错误
**问题**: 库名拼写错误但意图明确

**处理**:
```python
# 标准答案 (1分)
import numpy as np

# 拼写错误 (0.5分)
import nmupy as np  # 意图明确但错误

# 完全错误 (0分)
import math as np  # 导入错误的库
```

**评分**: 意图明确的拼写错误给50%，完全错误给0分

---

## 批量评分工作流程

### 步骤1: 准备数据
```
submissions/
├── 考生001/
│   ├── task1.py
│   ├── task2.py
│   ├── task3.py
│   └── task4.py
├── 考生002/
│   └── ...
```

---

### 步骤2: 使用大模型评分
对每位考生的每个文件，使用评分prompt进行评分

---

### 步骤3: 汇总结果
生成评分表格：

| 考生编号 | Task1 | Task2 | Task3 | Task4 | 总分 | 排名 |
|---------|-------|-------|-------|-------|------|------|
| 001     | 18    | 25    | 30    | 13    | 86   | 1    |
| 002     | 15    | 22    | 28    | 12    | 77   | 2    |

---

## 质量控制建议

### 1. 抽样复查
- 随机抽取10%-20%的答卷人工复查
- 重点复查边界分数（如59分、79分）
- 检查大模型评分一致性

---

### 2. 多模型交叉验证
使用多个大模型对同一份答卷评分，取平均值：
- Claude (Sonnet 4.5)
- GPT-4
- Gemini Pro

如果分数差异>10分，需要人工介入

---

### 3. 争议处理
对于以下情况建议人工复审：
- 总分<40分（可能是大模型误判）
- 总分>95分（需确认是否过度宽容）
- 评分理由不充分或矛盾

---

## 示例评分结果

### 示例1: 优秀答卷 (95分)

```
## Task 1: 图像预处理 (19/20分)

### TODO 1: 导入Python库 (2/2分)
✓ import numpy as np - 正确
✓ import matplotlib.pyplot as plt - 正确

### TODO 2: 图像锐化 - 绘制原图直方图 (3/3分)
✓ gray_img.ravel() - 正确
✓ 256 - 正确
✓ (0, 256) - 正确
✓ f"{save_prefix}_hist_before.png" - 正确

### TODO 3: 图像锐化 - 拉普拉斯算子 (2/2分)
✓ cv2.Laplacian(gray_img, cv2.CV_64F) - 正确

[...继续其他TODO...]

**Task 1总分**: 19/20分
**扣分点**: TODO 6形态学运算缺少kernel参数(-1分)
```

---

### 示例2: 中等答卷 (72分)

```
## Task 2: CNN模型训练 (20/30分)

### TODO 4: 模型搭建 (5/8分)
✗ 通道数配置: 32→64→64→128 (应为16→32→64→128)
  - 第一层输出通道错误: 32应为16 (-1.5分)
  - 第三层输出通道错误: 64应为64 (正确)
  - 整体架构基本正确，酌情给5分

### TODO 5: 前向传播 (4/6分)
✓ self.cnn(x) - 正确 (2/2分)
✗ 缺少self.dropout(x) - 错误 (0/1分)
✓ self.fc(x) - 正确 (1.5/1.5分)
✗ self.avgpool未正确调用 (0.5/1.5分)

[...继续其他TODO...]

**Task 2总分**: 20/30分
**主要问题**:
1. 模型架构通道数配置错误
2. 前向传播缺少Dropout层
3. 池化层未正确使用
```

---

### 示例3: 较差答卷 (45分)

```
## Task 3: Tkinter GUI应用 (10/35分)

### TODO 1: 上传图片函数 (2/4分)
✓ filedialog.askopenfilename - 正确 (2分)
✗ 文件类型过滤缺失 - 错误 (0/2分)

### TODO 2: 显示图片预览 (0/4分)
✗ 未实现缩略图功能 - 完全错误
✗ PhotoImage转换缺失

### TODO 12-14: GUI按钮创建 (0/9分)
✗ 所有按钮均未创建 - 空白

**Task 3总分**: 10/35分
**主要问题**:
1. GUI组件创建严重不完整
2. 图片预处理逻辑缺失
3. 事件绑定错误
**建议**: 需重新学习Tkinter基础知识
```

---

## 附录: 常见错误速查表

| 错误类型 | 标准答案 | 常见错误 | 给分 |
|---------|---------|---------|------|
| 导入numpy | `import numpy as np` | `import np` | 0分 |
| 展平数组 | `img.ravel()` | `img` | 50% |
| 形态学运算 | `cv2.MORPH_CLOSE` | `cv2.MORPH_OPEN` | 67% |
| 数据集长度 | `len(self.samples)` | `self.samples` | 0分 |
| 双向LSTM输出 | `128*2` | `128` | 0分 |
| 文件对话框 | `askopenfilename` | `openfilename` | 50% |
| CSV保存 | `.to_csv(...)` | `.save(...)` | 0分 |
| 显示图形 | `plt.show()` | `plt.display()` | 0分 |

---

## 联系与反馈

如在评分过程中遇到问题或发现评分标准需要调整，请记录具体案例以便后续优化评分标准。
