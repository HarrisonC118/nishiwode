# 学生组评分标准（总分100分）

## Task 1: 图像预处理 (20分)

### TODO 1: 导入Python库 (2分)
**位置**: 第6-7行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `import ...... as np` | `numpy` | 1分 | 完全正确1分；写`np`不给分 |
| `import ...... as plt` | `matplotlib.pyplot` | 1分 | 完全正确1分；写`matplotlib`给0.5分 |

---

### TODO 2: 图像锐化 - 绘制原图直方图 (3分)
**位置**: 第31-34行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `plt.hist(......, ......, ......)` 第1个空 | `gray_img.ravel()` | 1分 | `gray_img.ravel()`或`gray_img.flatten()`均给1分；只写变量名`gray_img`给0.5分 |
| `plt.hist(......, ......, ......)` 第2个空 | `256` | 0.5分 | 正确给0.5分；其他合理区间值（如128-512）给0.3分 |
| `plt.hist(......, ......, ......)` 第3个空 | `(0, 256)` | 0.5分 | 正确给0.5分；`[0, 256]`也给0.5分 |
| `plt.savefig(......)` | `f"{save_prefix}_hist_before.png"` | 1分 | 使用f-string且文件名包含`_hist_before.png`给1分；使用字符串拼接（如`str(save_prefix) + "_hist_before.png"`）给0.8分；只有文件名但缺少变量给0.3分 |

---

### TODO 3: 图像锐化 - 使用拉普拉斯算子 (2分)
**位置**: 第39行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `laplacian = cv2.......` | `Laplacian(gray_img, cv2.CV_64F)` | 2分 | 完全正确给2分；函数名正确但参数错误给1分；缺少第二个参数给1.5分 |

---

### TODO 4: 图像滤波 - 高斯滤波 (2分)
**位置**: 第52行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `img_gray_f = cv2.......` | `GaussianBlur(img_gray, (5, 5), 0)` | 2分 | 完全正确给2分；函数名正确但核大小错误（如`(3,3)`）给1.5分；函数名错误但是其他滤波函数（如`blur`）给1分 |

---

### TODO 5: 图像分辨率统一 (2分)
**位置**: 第62行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `cv2.resize(......, ......)` 第1个空 | `img` | 1分 | 正确给1分 |
| `cv2.resize(......, ......)` 第2个空 | `IMG_SIZE` | 1分 | `IMG_SIZE`或`(80, 80)`均给1分 |

---

### TODO 6: 图像增强 - 形态学闭运算 (3分)
**位置**: 第70行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `gray = cv2.......` | `morphologyEx(gray, cv2.MORPH_CLOSE, kernel)` | 3分 | 完全正确给3分；函数名正确但操作类型错误（如`MORPH_OPEN`）给2分；缺少kernel参数给2分 |

---

### TODO 7: 数据增强 - 垂直镜像操作 (6分)
**位置**: 第76-79行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `cv2.flip(......, ......)` 第1个空 | `sharpened` | 1分 | 正确给1分 |
| `cv2.flip(......, ......)` 第2个空 | `0` | 1分 | `0`给1分；`1`（水平翻转）给0.5分 |
| 保存锐化图像文件名 | `"_sharpened.png"` | 2分 | 完全正确给2分；文件名正确但引号类型错误给1.8分 |
| 保存垂直翻转图像文件名 | `"_flipv.png"` | 2分 | 完全正确给2分；写成`"_flip.png"`或`"_vertical.png"`给1.5分 |

---

## Task 2: CNN模型训练 (30分)

### TODO 1: 数据集封装 - `__init__`方法 (4分)
**位置**: 第53-54行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `line.rstrip(......)` | `"\n"` | 1分 | `"\n"`或不填（默认去除空白）均给1分 |
| `self.samples.append((......, ......))` 第1个空 | `p` | 1.5分 | 正确给1.5分 |
| `self.samples.append((......, ......))` 第2个空 | `t` | 1.5分 | 正确给1.5分 |

---

### TODO 2: 数据集封装 - `__len__`方法 (2分)
**位置**: 第59行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `return ......` | `len(self.samples)` | 2分 | 完全正确给2分；只写`self.samples`不给分 |

---

### TODO 3: 数据集封装 - `__getitem__`方法 (3分)
**位置**: 第73行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `return ......, ......` 第1个空 | `img` | 1.5分 | 正确给1.5分 |
| `return ......, ......` 第2个空 | `target` | 1.5分 | 正确给1.5分 |

---

### TODO 4: 模型搭建 - 构建CNN卷积层 (8分)
**位置**: 第94-97行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| 第一层输出通道 | `16` | 1.5分 | 正确给1.5分 |
| 第二层输入通道 | `16` | 1分 | 正确给1分 |
| 第二层输出通道 | `32` | 1.5分 | 正确给1.5分 |
| 第三层输入通道 | `32` | 1分 | 正确给1分 |
| 第三层输出通道 | `64` | 1.5分 | 正确给1.5分 |
| 第四层输入通道 | `64` | 1分 | 正确给1分 |
| 第四层输出通道 | `128` | 1.5分 | 正确给1.5分 |
| `self.fc` 全连接层输入 | `128` | 1分 | 正确给1分 |

**注意**: 通道数需要前后对应，如果考生整体架构正确但数值不同（如16/32/64/128改为32/64/128/256），酌情给6-7分。

---

### TODO 5: 前向传播实现 (6分)
**位置**: 第104-107行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `x = self.......` (CNN) | `cnn(x)` | 2分 | 正确给2分 |
| `x = self.......` (池化) | `avgpool(x)` | 1.5分 | 正确给1.5分 |
| `x = self.......` (Dropout) | `dropout(x)` | 1分 | 正确给1分；缺少此步骤给0分 |
| `x = self.......` (全连接) | `fc(x)` | 1.5分 | 正确给1.5分 |

---

### TODO 6: 训练函数实现 (5分)
**位置**: 第145行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `range(......, ......)` 第1个空 | `1` | 1分 | `1`或`0`均给1分 |
| `range(......, ......)` 第2个空 | `EPOCHS + 1` | 2分 | `EPOCHS + 1`或`EPOCHS`（如果第一个空是0）给2分；只写`EPOCHS`且第一个空是1给1分 |

---

### TODO 7: 模型保存 (2分)
**位置**: 第162行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `torch......(model.state_dict(), SAVE_PATH)` | `.save` | 2分 | 完全正确给2分；缺少`.state_dict()`给1分 |

---

## Task 3: Tkinter GUI应用 (35分)

### TODO 1: 上传图片函数 - 打开文件对话框 (4分)
**位置**: 第48-51行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `filedialog.......(` | `askopenfilename` | 2分 | 正确给2分 |
| `filetypes=[("Image Files", ......)]` | `"*.jpg *.jpeg *.png"` | 2分 | 包含三种格式给2分；包含两种给1.5分；只有一种给1分 |

---

### TODO 2: 显示图片预览 (4分)
**位置**: 第58-60行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `image.thumbnail((......, ......))` 第1个空 | `400` | 1分 | 正确给1分 |
| `image.thumbnail((......, ......))` 第2个空 | `300` | 1分 | 正确给1分 |
| `photo = ......` | `ImageTk.PhotoImage(image)` | 2分 | 完全正确给2分；只写`PhotoImage(image)`给1分 |

---

### TODO 3: 图片识别函数 - 检查上传 (2分)
**位置**: 第72行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `......("Warning", ...)` | `messagebox.showwarning` | 2分 | 完全正确给2分；只写`showwarning`给1.5分 |

---

### TODO 4: 调用模型进行识别 (2分)
**位置**: 第76行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `preprocess_image(......)` | `current_image_path` | 2分 | 正确给2分 |

---

### TODO 5: 显示识别结果 (2分)
**位置**: 第87行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `result_label.config(......)` | `text=result_text` | 2分 | 正确给2分；只写`result_text`给1分 |

---

### TODO 6: 批量识别函数 - 选择文件夹 (2分)
**位置**: 第93行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `filedialog.......(title=...)` | `askdirectory` | 2分 | 正确给2分 |

---

### TODO 7: 遍历文件夹批量识别 (2分)
**位置**: 第101行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `if filename.lower()......:` | `.endswith(('.jpg', '.jpeg', '.png'))` | 2分 | 正确给2分；只检查一种格式给1分 |

---

### TODO 8: 保存识别结果为CSV (4分)
**位置**: 第117-118行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `columns=[......]` | `["filename", "barcode", "valid"]` | 2分 | 三个列名都正确给2分；顺序错误但名称正确给1.5分 |
| `df.......(output_csv, index=False)` | `.to_csv` | 2分 | 正确给2分 |

---

### TODO 9: 弹窗提示完成 (2分)
**位置**: 第122行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `......showinfo("Complete", ...)` | `messagebox.` | 2分 | `messagebox.showinfo`给2分；只写`showinfo`给1.5分 |

---

### TODO 10: 界面功能 - 创建图片显示区 (2分)
**位置**: 第149行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `img_label = ......(left_frame, ...)` | `Label` | 2分 | 正确给2分 |

---

### TODO 11: 界面功能 - 创建结果显示区 (2分)
**位置**: 第159行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `result_label = ......(right_frame, ...)` | `Label` | 2分 | 正确给2分 |

---

### TODO 12: 界面功能 - 创建上传按钮 (3分)
**位置**: 第164行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `upload_btn = ......(` | `Button` | 1分 | 正确给1分 |
| `text=......` | `"Upload Barcode Image"` | 1分 | 正确给1分 |
| `command=......` | `upload_image` | 1分 | 正确给1分 |

---

### TODO 13: 界面功能 - 创建识别按钮 (3分)
**位置**: 第169行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `recognize_btn = ......(` | `Button` | 1分 | 正确给1分 |
| `text=......` | `"Recognize Barcode"` | 1分 | 正确给1分 |
| `command=......` | `recognize_single` | 1分 | 正确给1分 |

---

### TODO 14: 界面功能 - 创建批量识别按钮 (3分)
**位置**: 第174行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `batch_btn = ......(` | `Button` | 1分 | 正确给1分 |
| `text=......` | `"Batch Recognize"` | 1分 | 正确给1分 |
| `command=......` | `batch_recognize` | 1分 | 正确给1分 |

---

## Task 4: 训练结果可视化 (15分)

### TODO 1: 导入Python库 (2分)
**位置**: 第6-7行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `import ...... as pd` | `pandas` | 1分 | 正确给1分 |
| `import ...... as plt` | `matplotlib.pyplot` | 1分 | 正确给1分；写`matplotlib`给0.5分 |

---

### TODO 2: 准确率计算 - 读取CSV (2分)
**位置**: 第15行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `log = pd.......` | `read_csv(LOG_CSV)` | 2分 | 完全正确给2分；只写函数名给1分 |

---

### TODO 3: 柱状图绘制 (3分)
**位置**: 第20行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `plt.......` | `bar(log['epoch'], log['val_acc'])` | 3分 | 函数名和参数都正确给3分；函数名正确但参数错误给2分；使用`plot`替代`bar`给2分 |

---

### TODO 4: 设置图表标题 (2分)
**位置**: 第25行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `plt.......` | `title("EAN/UPC Barcode Recognition Accuracy")` | 2分 | 完全正确给2分；只写函数名`title`给1分 |

---

### TODO 5: 设置坐标轴标签 (4分)
**位置**: 第30-31行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `plt.......` (x轴) | `xlabel("Epoch")` | 2分 | 完全正确给2分；只写函数名给1分 |
| `plt.......` (y轴) | `ylabel("Accuracy")` | 2分 | 完全正确给2分；只写函数名给1分 |

---

### TODO 6: 结果展示 - 显示图形 (2分)
**位置**: 第45行

| 空位 | 标准答案 | 分值 | 评分标准 |
|------|---------|------|---------|
| `plt.......` | `show()` | 2分 | 正确给2分 |

---

## 评分注意事项

### 通用原则
1. **完全正确**: 代码语法正确、逻辑正确、能正常运行，给该空的全部分数
2. **部分正确**:
   - 代码逻辑正确但有小错误（如拼写错误、缺少括号）：给70%-90%分数
   - 使用了替代方案且功能等效：给80%-100%分数
   - 参数不完整但核心正确：给60%-80%分数
3. **基本正确**: 思路正确但实现有误：给40%-60%分数
4. **错误**: 完全错误或空白：0分

### 特殊情况处理
1. **导入库**: 如果库名拼写错误但意图明确（如`nmupy`），给50%分数
2. **函数调用**: 如果函数名正确但参数顺序错误，酌情给60%-80%分数
3. **字符串**: 单引号和双引号视为等效
4. **变量命名**: 如果使用了不同但合理的变量名，只要逻辑正确即给分
5. **格式化字符串**: f-string、.format()、%格式化、字符串拼接，只要结果正确都可给分

### 大模型评分指令
当使用大模型评分时，请提供：
1. 考生的完整代码
2. 每个TODO对应的行号范围
3. 要求大模型输出：
   - 每个空的得分
   - 扣分原因（如果有）
   - 总分
   - 建议改进（可选）
